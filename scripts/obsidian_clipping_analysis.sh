#!/bin/bash
# Obsidian Clipping åˆ†æžä»»åŠ¡
# æ¯æ—¥23:00è¿è¡Œï¼Œåˆ†æžå½“å¤©æ”¶é›†çš„æ–‡ç« 

VAULT_PATH="$HOME/Documents/Obsidian Vault"
CLIPPING_FOLDER="$VAULT_PATH/clipping"
OUTPUT_FOLDER="$VAULT_PATH/clipping_analysis"

# èŽ·å–ä»Šå¤©çš„æ—¥æœŸ
TODAY=$(date +%Y-%m-%d)
TODAY_FILES=$(find "$CLIPPING_FOLDER" -name "*.md" -newermt "$TODAY 00:00" ! -newermt "$TODAY 23:59" 2>/dev/null)

if [ -z "$TODAY_FILES" ]; then
    echo "ðŸ“­ $TODAY æ²¡æœ‰æ–°æ”¶é›†çš„æ–‡ç« "
    exit 0
fi

echo "ðŸ“š å‘çŽ° $(echo "$TODAY_FILES" | wc -l) ç¯‡æ–‡ç« éœ€è¦åˆ†æž"

# åˆ›å»ºè¾“å‡ºç›®å½•
mkdir -p "$OUTPUT_FOLDER/$TODAY"

# ç”Ÿæˆåˆ†æžè¯·æ±‚
cat > "/tmp/obsidian_analysis_request.md" << EOF
# Obsidian Clipping åˆ†æžè¯·æ±‚ | $TODAY

## å¾…åˆ†æžæ–‡ç« 

$(for file in $TODAY_FILES; do
    echo "### $(basename "$file" .md)"
    echo "\`\`\`"
    head -50 "$file"
    echo "\`\`\`"
    echo ""
done)

---

## åˆ†æžè¦æ±‚

1. **æ–‡ç« åˆ†ç±»**ï¼šæŒ‰ä¸»é¢˜/é¢†åŸŸåˆ†ç±»ï¼ˆæŠ€æœ¯/å•†ä¸š/æ€è€ƒ/å…¶ä»–ï¼‰
2. **æ¯ç¯‡æ–‡ç« åˆ†æž**ï¼š
   - âœ… ä¼˜ç‚¹ï¼šæ ¸å¿ƒä»·å€¼å’Œäº®ç‚¹
   - âš ï¸ ä¸è¶³ï¼šå¯æ”¹è¿›ä¹‹å¤„æˆ–éœ€éªŒè¯çš„å†…å®¹
   - ðŸ’¡ è¡ŒåŠ¨å»ºè®®ï¼šæ˜¯å¦éœ€è¦æ·±å…¥ç ”ç©¶æˆ–å®žè·µ
3. **è·¨æ–‡ç« å…³è”**ï¼šæ‰¾å‡ºæ–‡ç« é—´çš„è”ç³»å’Œå…±åŒä¸»é¢˜
4. **çŸ¥è¯†æ²‰æ·€**ï¼šæå–å¯é•¿æœŸä¿å­˜çš„æ ¸å¿ƒæ´žå¯Ÿ

## è¾“å‡ºæ ¼å¼

\`\`\`
## ðŸ“Š $TODAY æ–‡ç« åˆ†æžæ€»ç»“

### åˆ†ç±»æ¦‚è§ˆ
- ðŸ“š [ç±»åˆ«1]: Xç¯‡
- ðŸ“š [ç±»åˆ«2]: Xç¯‡
...

### å•ç¯‡åˆ†æž

#### 1. [æ–‡ç« æ ‡é¢˜]
**åˆ†ç±»**: [ç±»åˆ«]
**ä¼˜ç‚¹**: 
- [äº®ç‚¹1]
- [äº®ç‚¹2]
**ä¸è¶³**:
- [å¯æ”¹è¿›å¤„]
**è¡ŒåŠ¨å»ºè®®**: [å…·ä½“å»ºè®®]

### è·¨æ–‡ç« æ´žå¯Ÿ
[å‘çŽ°çš„å…±åŒä¸»é¢˜æˆ–è”ç³»]

### çŸ¥è¯†æ²‰æ·€
[éœ€è¦é•¿æœŸä¿å­˜çš„æ ¸å¿ƒè§‚ç‚¹]
\`\`\`

EOF

echo "âœ… åˆ†æžè¯·æ±‚å·²ç”Ÿæˆ: /tmp/obsidian_analysis_request.md"
echo "ðŸ“ è¾“å‡ºå°†ä¿å­˜åˆ°: $OUTPUT_FOLDER/$TODAY/"
